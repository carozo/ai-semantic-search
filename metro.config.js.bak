const { getDefaultConfig } = require("expo/metro-config");
const defaultResolver = require("metro-resolver").resolve;

const config = getDefaultConfig(__dirname);

config.resolver.resolveRequest = (
  context,
  moduleName,
  platform,
  realModuleName
) => {
  if (moduleName === "fs/promises") {
    return {
      filePath: "fs-stub.js",
      type: "sourceFile",
    };
  } else {
    return defaultResolver(
      {
        ...context,
      },
      moduleName,
      platform,
      realModuleName
    );
  }
};

module.exports = config;
